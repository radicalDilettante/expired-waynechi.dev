<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="https://waynethebb.github.io/_next/static/css/b1bb8fa9e8f4ae24581f.css" as="style"/><link rel="stylesheet" href="https://waynethebb.github.io/_next/static/css/b1bb8fa9e8f4ae24581f.css" data-n-g=""/><link rel="preload" href="https://waynethebb.github.io/_next/static/css/38a4b6f7570fee24e93f.css" as="style"/><link rel="stylesheet" href="https://waynethebb.github.io/_next/static/css/38a4b6f7570fee24e93f.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="https://waynethebb.github.io/_next/static/chunks/polyfills-e7a279300235e161e32a.js"></script><script src="https://waynethebb.github.io/_next/static/chunks/webpack-44f8ebc2c9169a6ece59.js" defer=""></script><script src="https://waynethebb.github.io/_next/static/chunks/framework-44ddc888f4db0c68c97f.js" defer=""></script><script src="https://waynethebb.github.io/_next/static/chunks/main-e5f07ede970874fa4e5d.js" defer=""></script><script src="https://waynethebb.github.io/_next/static/chunks/pages/_app-90e39a03d0191b8ff742.js" defer=""></script><script src="https://waynethebb.github.io/_next/static/chunks/792-7d66d13204f9e0b4b42d.js" defer=""></script><script src="https://waynethebb.github.io/_next/static/chunks/pages/blog/%5Bslug%5D-b9c429ab487548848ab6.js" defer=""></script><script src="https://waynethebb.github.io/_next/static/sLsnVHm4E6bG3kHgTY_x-/_buildManifest.js" defer=""></script><script src="https://waynethebb.github.io/_next/static/sLsnVHm4E6bG3kHgTY_x-/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="layout_container__1ROar"><header class="header_container__2Vvjg"><h1 class="header_name__2PEvs">Wayne Choi</h1><p class="header_desc__3Cwo2">Web developer &amp; Boat builder</p><ul class="header_list__2sooW"><li class="header_item_list_item__33J-y"><a href="/">HOME</a></li><li class="header_item_list_item__33J-y"><a href="/about">ABOUT</a></li><li class="header_item_list_item__33J-y"><a href="/blog">BLOG</a></li><li class="header_item_list_item__33J-y"><a href="/work">WORK</a></li></ul></header><section class="layout_contentsWrapper__3Npc0"><div class="post_container__3sy9-"><img src="https://waynethebb.github.io//images/posts/neoquery.png" class="post_img__Q7UJV" alt="Variable declaration in JavaScript Module"/><h1>Variable declaration in JavaScript Module</h1>
<p>This study started with only a single line of code I did not understand.</p>
<pre><div style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-javascript" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// type = &quot;module&quot;</span><span>
</span><span></span><span class="token console" style="color:#DD4A68">console</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">log</span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">this</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// undefined</span></code></div></pre>
<hr/>
<h2>Where the hell is &quot;window&quot;?</h2>
<p>In the global execution context (outside of any function), &quot;this&quot; refers to the global object. If its runtime environment is a browser, it is &quot;window&quot;. In module JavaScript, however, &quot;this&quot; refers to &quot;undefined&quot; in the top level context.</p>
<p>Modules are imported into the scope of single scripts. They cannot be called from global scope.</p>
<p>Modules have a lexical top-level scope. This means that for example, running var foo = 42; within a module does not create a global variable named foo, accessible through window.foo in a browser, although that would be the case in a classic script.</p>
<p>Similarly, the this within modules does not refer to the global this, and instead is undefined.</p>
<hr/>
<h2>Variables Declaration</h2>
<p>All variables in JavaScript is properties of objects, and a global object is assigned to a property of global object.</p>
<pre><div style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-javascript" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#07a">var</span><span> a </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#690">&quot;hi&quot;</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token console" style="color:#DD4A68">console</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">log</span><span class="token" style="color:#999">(</span><span>a</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// hi</span><span>
</span><span></span><span class="token console" style="color:#DD4A68">console</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">log</span><span class="token" style="color:#999">(</span><span class="token dom" style="color:#e90">window</span><span class="token" style="color:#999">.</span><span class="token property-access">a</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// hi</span><span>
</span><span></span><span class="token console" style="color:#DD4A68">console</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">log</span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">this</span><span class="token" style="color:#999">.</span><span class="token property-access">a</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// hi</span></code></div></pre>
<p>What object is variables, declared in top-level scope of modules, assigned to?</p>
<p>When variables is declared, it is assigned to a property of LexicalEnvironment component in execution context. In global context, LexicalEnvironment refer the global property. The variables in top-level scope of modules are assigned to LexicalEnvironment like any other execution contexts.</p>
<hr/>
<h2>&quot;var&quot; and &quot;let&quot;</h2>
<p>For both modules and commonjs, variables declared suing the &quot;let&quot;, and constants are not assigned to a global property, but only LexicalEnvironment.</p>
<pre><div style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-javascript" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#07a">let</span><span> a </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#690">&quot;hi&quot;</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token console" style="color:#DD4A68">console</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">log</span><span class="token" style="color:#999">(</span><span>a</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// hi</span><span>
</span><span></span><span class="token console" style="color:#DD4A68">console</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">log</span><span class="token" style="color:#999">(</span><span class="token dom" style="color:#e90">window</span><span class="token" style="color:#999">.</span><span class="token property-access">a</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// undefined</span><span>
</span><span></span><span class="token console" style="color:#DD4A68">console</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">log</span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">this</span><span class="token" style="color:#999">.</span><span class="token property-access">a</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// undefined</span></code></div></pre>
<hr/>
<h2>References</h2>
<ul>
<li>https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/this</li>
<li>https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules</li>
<li>https://v8.dev/features/modules#mjs</li>
</ul></div></section><footer class="layout_footer__2KiKH">(C) <!-- -->2021<!-- -->. Wonjun Choi. All rights reserved.</footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"frontMatter":{"title":"Variable declaration in JavaScript Module","date":"Sep 2, 2021","tag":"js-library,project","excerpt":"Amet reprehenderit mollit qui Lorem cupidatat adipisicing.","cover_image":"/images/posts/neoquery.png"},"content":"\r\n# Variable declaration in JavaScript Module\r\n\r\nThis study started with only a single line of code I did not understand.\r\n\r\n```javascript\r\n// type = \"module\"\r\nconsole.log(this); // undefined\r\n```\r\n\r\n---\r\n\r\n## Where the hell is \"window\"?\r\n\r\nIn the global execution context (outside of any function), \"this\" refers to the global object. If its runtime environment is a browser, it is \"window\". In module JavaScript, however, \"this\" refers to \"undefined\" in the top level context.\r\n\r\nModules are imported into the scope of single scripts. They cannot be called from global scope.\r\n\r\nModules have a lexical top-level scope. This means that for example, running var foo = 42; within a module does not create a global variable named foo, accessible through window.foo in a browser, although that would be the case in a classic script.\r\n\r\nSimilarly, the this within modules does not refer to the global this, and instead is undefined.\r\n\r\n---\r\n\r\n## Variables Declaration\r\n\r\nAll variables in JavaScript is properties of objects, and a global object is assigned to a property of global object.\r\n\r\n```javascript\r\nvar a = \"hi\";\r\nconsole.log(a); // hi\r\nconsole.log(window.a); // hi\r\nconsole.log(this.a); // hi\r\n```\r\n\r\nWhat object is variables, declared in top-level scope of modules, assigned to?\r\n\r\nWhen variables is declared, it is assigned to a property of LexicalEnvironment component in execution context. In global context, LexicalEnvironment refer the global property. The variables in top-level scope of modules are assigned to LexicalEnvironment like any other execution contexts.\r\n\r\n---\r\n\r\n## \"var\" and \"let\"\r\n\r\nFor both modules and commonjs, variables declared suing the \"let\", and constants are not assigned to a global property, but only LexicalEnvironment.\r\n\r\n```javascript\r\nlet a = \"hi\";\r\nconsole.log(a); // hi\r\nconsole.log(window.a); // undefined\r\nconsole.log(this.a); // undefined\r\n```\r\n\r\n---\r\n\r\n## References\r\n\r\n- https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/this\r\n- https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules\r\n- https://v8.dev/features/modules#mjs\r\n"},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"variable_declaration_in_javascript_module"},"buildId":"sLsnVHm4E6bG3kHgTY_x-","assetPrefix":"https://waynethebb.github.io","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>