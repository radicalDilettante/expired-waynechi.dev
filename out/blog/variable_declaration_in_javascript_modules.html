<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="https://waynechoi.dev/_next/static/css/cd6bb58612ca685fce56.css" as="style"/><link rel="stylesheet" href="https://waynechoi.dev/_next/static/css/cd6bb58612ca685fce56.css" data-n-g=""/><link rel="preload" href="https://waynechoi.dev/_next/static/css/95d278ad4e10159eb728.css" as="style"/><link rel="stylesheet" href="https://waynechoi.dev/_next/static/css/95d278ad4e10159eb728.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="https://waynechoi.dev/_next/static/chunks/polyfills-a40ef1678bae11e696dba45124eadd70.js"></script><script src="https://waynechoi.dev/_next/static/chunks/webpack-c6b64c99608fd9e03712.js" defer=""></script><script src="https://waynechoi.dev/_next/static/chunks/framework-44ddc888f4db0c68c97f.js" defer=""></script><script src="https://waynechoi.dev/_next/static/chunks/main-8af3309d1a9bc71624bc.js" defer=""></script><script src="https://waynechoi.dev/_next/static/chunks/pages/_app-0d9dafb4d24b80309445.js" defer=""></script><script src="https://waynechoi.dev/_next/static/chunks/368-de82a9ffaf4175eeadb0.js" defer=""></script><script src="https://waynechoi.dev/_next/static/chunks/pages/blog/%5Bslug%5D-8e89242e99a0639dde68.js" defer=""></script><script src="https://waynechoi.dev/_next/static/i6QZDsfc8m2eH-o1dQ1fc/_buildManifest.js" defer=""></script><script src="https://waynechoi.dev/_next/static/i6QZDsfc8m2eH-o1dQ1fc/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="layout_container__1ROar"><header class="layout_header__MPs9E"><div class="header_container__2Vvjg"><p class="header_name__2PEvs">WayneChoi.dev</p><ul class="header_list__2sooW"><li class="header_item_list_item__33J-y"><a href="/">HOME</a></li><li class="header_item_list_item__33J-y"><a href="/about">ABOUT</a></li><li class="header_item_list_item__33J-y"><a href="/blog">BLOG</a></li><li class="header_item_list_item__33J-y"><a href="/work">PORTFOLIO</a></li></ul></div></header><section class="layout_contents__wGaub"><div class="post_container__3sy9-"><p class="post_tag__38ugF"># <!-- -->JavaScript</p><h1 class="post_subject__1wsFG">Variable declaration in JavaScript Modules</h1><p class="post_date__2VDNf">Sep 2, 2021</p><p>This study started with only a single line of code I did not understand.</p>
<pre><div style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-javascript" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// type = &quot;module&quot;</span><span>
</span><span></span><span class="token console" style="color:#DD4A68">console</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">log</span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">this</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// undefined</span></code></div></pre>
<hr/>
<h2>Where the hell is &quot;window&quot;?</h2>
<p>In the global execution context (outside of any function), &quot;this&quot; refers to the global object. If its runtime environment is a browser, it is &quot;window&quot;. In module JavaScript, however, &quot;this&quot; refers to &quot;undefined&quot; in the top level context.</p>
<p>Modules are imported into the scope of single scripts. They cannot be called from global scope.</p>
<p>Modules have a lexical top-level scope. This means that for example, running var foo = 42; within a module does not create a global variable named foo, accessible through window.foo in a browser, although that would be the case in a classic script.</p>
<p>Similarly, the this within modules does not refer to the global this, and instead is undefined.</p>
<hr/>
<h2>Variables Declaration</h2>
<p>All variables in JavaScript is properties of objects, and a global variable is assigned to a property of global object.</p>
<pre><div style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-javascript" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#07a">var</span><span> a </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#690">&quot;hi&quot;</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token console" style="color:#DD4A68">console</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">log</span><span class="token" style="color:#999">(</span><span>a</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// hi</span><span>
</span><span></span><span class="token console" style="color:#DD4A68">console</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">log</span><span class="token" style="color:#999">(</span><span class="token dom" style="color:#e90">window</span><span class="token" style="color:#999">.</span><span class="token property-access">a</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// hi</span><span>
</span><span></span><span class="token console" style="color:#DD4A68">console</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">log</span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">this</span><span class="token" style="color:#999">.</span><span class="token property-access">a</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// hi</span></code></div></pre>
<p>What object is variables, declared in top-level scope of modules, assigned to?</p>
<p>When variables is declared, it is assigned to a property of LexicalEnvironment component in execution context. The variables in top-level scope of modules are also assigned to LexicalEnvironment like any other execution contexts, but not global object like global variable. Only global variable is assigned to the global object, and then LexicalEnvironment refer the global object.</p>
<hr/>
<h2>&quot;var&quot; and &quot;let&quot;</h2>
<p>For both modules and commonjs, variables declared suing the &quot;let&quot;, and constants are not assigned to a global property, but only LexicalEnvironment.</p>
<pre><div style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-javascript" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#07a">let</span><span> a </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#690">&quot;hi&quot;</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token console" style="color:#DD4A68">console</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">log</span><span class="token" style="color:#999">(</span><span>a</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// hi</span><span>
</span><span></span><span class="token console" style="color:#DD4A68">console</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">log</span><span class="token" style="color:#999">(</span><span class="token dom" style="color:#e90">window</span><span class="token" style="color:#999">.</span><span class="token property-access">a</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// undefined</span><span>
</span><span></span><span class="token console" style="color:#DD4A68">console</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">log</span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">this</span><span class="token" style="color:#999">.</span><span class="token property-access">a</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// undefined</span></code></div></pre>
<hr/>
<h2>References</h2>
<ul>
<li><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Operators/this">this - JavaScript | MDN</a></li>
<li><a href="https://developer.mozilla.org/docs/Web/JavaScript/Guide/Modules">JavaScript modules - JavaScript | MDN</a></li>
<li><a href="https://v8.dev/features/modules#mjs">JavaScript modules · V8</a></li>
</ul></div></section><footer class="layout_footer__2KiKH">(C) <!-- -->2021<!-- -->. Wonjun Choi. All rights reserved.</footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"frontMatter":{"title":"Variable declaration in JavaScript Modules","date":"Sep 2, 2021","tag":"JavaScript","excerpt":"In module JavaScript, however, \"this\" refers to \"undefined\" in the top level context... "},"content":"\r\nThis study started with only a single line of code I did not understand.\r\n\r\n```javascript\r\n// type = \"module\"\r\nconsole.log(this); // undefined\r\n```\r\n\r\n---\r\n\r\n## Where the hell is \"window\"?\r\n\r\nIn the global execution context (outside of any function), \"this\" refers to the global object. If its runtime environment is a browser, it is \"window\". In module JavaScript, however, \"this\" refers to \"undefined\" in the top level context.\r\n\r\nModules are imported into the scope of single scripts. They cannot be called from global scope.\r\n\r\nModules have a lexical top-level scope. This means that for example, running var foo = 42; within a module does not create a global variable named foo, accessible through window.foo in a browser, although that would be the case in a classic script.\r\n\r\nSimilarly, the this within modules does not refer to the global this, and instead is undefined.\r\n\r\n---\r\n\r\n## Variables Declaration\r\n\r\nAll variables in JavaScript is properties of objects, and a global variable is assigned to a property of global object.\r\n\r\n```javascript\r\nvar a = \"hi\";\r\nconsole.log(a); // hi\r\nconsole.log(window.a); // hi\r\nconsole.log(this.a); // hi\r\n```\r\n\r\nWhat object is variables, declared in top-level scope of modules, assigned to?\r\n\r\nWhen variables is declared, it is assigned to a property of LexicalEnvironment component in execution context. The variables in top-level scope of modules are also assigned to LexicalEnvironment like any other execution contexts, but not global object like global variable. Only global variable is assigned to the global object, and then LexicalEnvironment refer the global object.\r\n\r\n---\r\n\r\n## \"var\" and \"let\"\r\n\r\nFor both modules and commonjs, variables declared suing the \"let\", and constants are not assigned to a global property, but only LexicalEnvironment.\r\n\r\n```javascript\r\nlet a = \"hi\";\r\nconsole.log(a); // hi\r\nconsole.log(window.a); // undefined\r\nconsole.log(this.a); // undefined\r\n```\r\n\r\n---\r\n\r\n## References\r\n\r\n- [this - JavaScript | MDN](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Operators/this)\r\n- [JavaScript modules - JavaScript | MDN](https://developer.mozilla.org/docs/Web/JavaScript/Guide/Modules)\r\n- [JavaScript modules · V8](https://v8.dev/features/modules#mjs)\r\n"},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"variable_declaration_in_javascript_modules"},"buildId":"i6QZDsfc8m2eH-o1dQ1fc","assetPrefix":"https://waynechoi.dev","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>