<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Variable declaration in JavaScript Modules - WayneChoi.dev</title><meta name="author" content="Wayne Choi"/><meta name="description" content="In module JavaScript, however, &quot;this&quot; refers to &quot;undefined&quot; in the top level context..."/><meta name="keywords" content="JavaScript"/><meta name="next-head-count" content="6"/><link rel="preload" href="https://waynechoi.dev/_next/static/css/a4a2eb3c6228baf493b9.css" as="style"/><link rel="stylesheet" href="https://waynechoi.dev/_next/static/css/a4a2eb3c6228baf493b9.css" data-n-g=""/><link rel="preload" href="https://waynechoi.dev/_next/static/css/cde35213adb84359b33a.css" as="style"/><link rel="stylesheet" href="https://waynechoi.dev/_next/static/css/cde35213adb84359b33a.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="https://waynechoi.dev/_next/static/chunks/polyfills-a40ef1678bae11e696dba45124eadd70.js"></script><script src="https://waynechoi.dev/_next/static/chunks/webpack-d485bbc1d791f1a283b8.js" defer=""></script><script src="https://waynechoi.dev/_next/static/chunks/framework-b97a0ed4f13ff8397343.js" defer=""></script><script src="https://waynechoi.dev/_next/static/chunks/main-c4f2541b93e4ae8b71f8.js" defer=""></script><script src="https://waynechoi.dev/_next/static/chunks/pages/_app-bc781eda49c3fa74d5c0.js" defer=""></script><script src="https://waynechoi.dev/_next/static/chunks/610-041eb31b214f3f448fbb.js" defer=""></script><script src="https://waynechoi.dev/_next/static/chunks/pages/%5Bslug%5D-e222e7756b964d9823fd.js" defer=""></script><script src="https://waynechoi.dev/_next/static/mWOa3K8bHiCI7Nm2jAixL/_buildManifest.js" defer=""></script><script src="https://waynechoi.dev/_next/static/mWOa3K8bHiCI7Nm2jAixL/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="layout_container__1ROar"><header class="layout_header__MPs9E"><div class="header_container__2Vvjg"><div class="header_header__3lGRs"><button class="header_mobileMenuButton__1vVY8"><img alt="menu" src="https://waynechoi.dev/images/menu.svg"/></button><a class="header_name__2PEvs" href="/">WayneChoi.dev</a><ul class="header_list__2sooW"><li class="header_item_list_item__33J-y"><a href="/">HOME</a></li><li class="header_item_list_item__33J-y"><a href="/about">ABOUT</a></li><li class="header_item_list_item__33J-y"><a href="/portfolio">PORTFOLIO</a></li></ul><div class="header_searchBar__3VAZB"><form class="search_bar_container__2559w"><input type="text" id="keyword" placeholder="keywords..." required=""/><button type="submit"><img alt="search" src="https://waynechoi.dev/images/search.svg"/></button></form></div><button class="header_mobileSearchButton__1r9xs"><img alt="search" src="https://waynechoi.dev/images/search.svg"/></button></div></div></header><section class="layout_contents__wGaub"><div class="blog_container__3EBzV"><div class="blog_tagWrapper__sYhAm"><span class="blog_tag__2jFK0">#<!-- -->JavaScript</span></div><h1 class="blog_h1__3s5r-">Variable declaration in JavaScript Modules</h1><span class="blog_date__2SU8B">Sep 2, 2021</span><div class="blog_content__mgCMi"><div><div>
<p>This study started with only a single line of code I did not understand.</p><pre><code class="lang-javascript">// type = &quot;module&quot;
console.log(this); // undefined</code></pre><hr/><h2 id="where-the-hell-is-window">Where the hell is &quot;window&quot;?</h2><p>In the global execution context (outside of any function), &quot;this&quot; refers to the global object. If its runtime environment is a browser, it is &quot;window&quot;. In module JavaScript, however, &quot;this&quot; refers to &quot;undefined&quot; in the top level context.</p><p>Modules are imported into the scope of single scripts. They cannot be called from global scope.</p><p>Modules have a lexical top-level scope. This means that for example, running var foo = 42; within a module does not create a global variable named foo, accessible through window.foo in a browser, although that would be the case in a classic script.</p><p>Similarly, the this within modules does not refer to the global this, and instead is undefined.</p><hr/><h2 id="variables-declaration">Variables Declaration</h2><p>All variables in JavaScript is properties of objects, and a global variable is assigned to a property of global object.</p><pre><code class="lang-javascript">var a = &quot;hi&quot;;
console.log(a); // hi
console.log(window.a); // hi
console.log(this.a); // hi</code></pre><p>What object is variables, declared in top-level scope of modules, assigned to?</p><p>When variables is declared, it is assigned to a property of LexicalEnvironment component in execution context. The variables in top-level scope of modules are also assigned to LexicalEnvironment like any other execution contexts, but not global object like global variable. Only global variable is assigned to the global object, and then LexicalEnvironment refer the global object.</p><hr/><h2 id="var-and-let">&quot;var&quot; and &quot;let&quot;</h2><p>For both modules and commonjs, variables declared suing the &quot;let&quot;, and constants are not assigned to a global property, but only LexicalEnvironment.</p><pre><code class="lang-javascript">let a = &quot;hi&quot;;
console.log(a); // hi
console.log(window.a); // undefined
console.log(this.a); // undefined</code></pre><hr/><h2 id="references">References</h2><ul><li><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Operators/this">this - JavaScript | MDN</a></li><li><a href="https://developer.mozilla.org/docs/Web/JavaScript/Guide/Modules">JavaScript modules - JavaScript | MDN</a></li><li><a href="https://v8.dev/features/modules#mjs">JavaScript modules · V8</a></li></ul></div></div></div><div id="utterances_container"></div></div></section><footer class="layout_footer__2KiKH">(C) <!-- -->2021<!-- -->. Wonjun Choi. All rights reserved.</footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"frontMatter":{"title":"Variable declaration in JavaScript Modules","date":"Sep 2, 2021","tag":["JavaScript"],"excerpt":"In module JavaScript, however, \"this\" refers to \"undefined\" in the top level context..."},"content":"\r\nThis study started with only a single line of code I did not understand.\r\n\r\n```javascript\r\n// type = \"module\"\r\nconsole.log(this); // undefined\r\n```\r\n\r\n---\r\n\r\n## Where the hell is \"window\"?\r\n\r\nIn the global execution context (outside of any function), \"this\" refers to the global object. If its runtime environment is a browser, it is \"window\". In module JavaScript, however, \"this\" refers to \"undefined\" in the top level context.\r\n\r\nModules are imported into the scope of single scripts. They cannot be called from global scope.\r\n\r\nModules have a lexical top-level scope. This means that for example, running var foo = 42; within a module does not create a global variable named foo, accessible through window.foo in a browser, although that would be the case in a classic script.\r\n\r\nSimilarly, the this within modules does not refer to the global this, and instead is undefined.\r\n\r\n---\r\n\r\n## Variables Declaration\r\n\r\nAll variables in JavaScript is properties of objects, and a global variable is assigned to a property of global object.\r\n\r\n```javascript\r\nvar a = \"hi\";\r\nconsole.log(a); // hi\r\nconsole.log(window.a); // hi\r\nconsole.log(this.a); // hi\r\n```\r\n\r\nWhat object is variables, declared in top-level scope of modules, assigned to?\r\n\r\nWhen variables is declared, it is assigned to a property of LexicalEnvironment component in execution context. The variables in top-level scope of modules are also assigned to LexicalEnvironment like any other execution contexts, but not global object like global variable. Only global variable is assigned to the global object, and then LexicalEnvironment refer the global object.\r\n\r\n---\r\n\r\n## \"var\" and \"let\"\r\n\r\nFor both modules and commonjs, variables declared suing the \"let\", and constants are not assigned to a global property, but only LexicalEnvironment.\r\n\r\n```javascript\r\nlet a = \"hi\";\r\nconsole.log(a); // hi\r\nconsole.log(window.a); // undefined\r\nconsole.log(this.a); // undefined\r\n```\r\n\r\n---\r\n\r\n## References\r\n\r\n- [this - JavaScript | MDN](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Operators/this)\r\n- [JavaScript modules - JavaScript | MDN](https://developer.mozilla.org/docs/Web/JavaScript/Guide/Modules)\r\n- [JavaScript modules · V8](https://v8.dev/features/modules#mjs)\r\n"},"__N_SSG":true},"page":"/[slug]","query":{"slug":"variable_declaration_in_javascript_modules"},"buildId":"mWOa3K8bHiCI7Nm2jAixL","assetPrefix":"https://waynechoi.dev","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>