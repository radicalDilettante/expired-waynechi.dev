<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Method returning callback with this for event handler - WayneChoi.dev</title><meta name="author" content="Wayne Choi"/><meta name="description" content="I met a trobule about this in a method returning callback for event handler. I fixed it with static method and other hack."/><meta name="keywords" content="Web,Cookie,JavaScript"/><meta name="next-head-count" content="6"/><link rel="preload" href="https://radicaldilettante.github.io/expired-waynechi.dev/_next/static/css/dd81c86663b99a7f14a1.css" as="style"/><link rel="stylesheet" href="https://radicaldilettante.github.io/expired-waynechi.dev/_next/static/css/dd81c86663b99a7f14a1.css" data-n-g=""/><link rel="preload" href="https://radicaldilettante.github.io/expired-waynechi.dev/_next/static/css/81065f7f6327d4b5d267.css" as="style"/><link rel="stylesheet" href="https://radicaldilettante.github.io/expired-waynechi.dev/_next/static/css/81065f7f6327d4b5d267.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="https://radicaldilettante.github.io/expired-waynechi.dev/_next/static/chunks/polyfills-a40ef1678bae11e696dba45124eadd70.js"></script><script src="https://radicaldilettante.github.io/expired-waynechi.dev/_next/static/chunks/webpack-12964ea9dded4c03389e.js" defer=""></script><script src="https://radicaldilettante.github.io/expired-waynechi.dev/_next/static/chunks/framework-0441fae7fd130f37dee1.js" defer=""></script><script src="https://radicaldilettante.github.io/expired-waynechi.dev/_next/static/chunks/main-c4f2541b93e4ae8b71f8.js" defer=""></script><script src="https://radicaldilettante.github.io/expired-waynechi.dev/_next/static/chunks/pages/_app-63898004e49723b3ce5c.js" defer=""></script><script src="https://radicaldilettante.github.io/expired-waynechi.dev/_next/static/chunks/113-578803495dd2b122acd7.js" defer=""></script><script src="https://radicaldilettante.github.io/expired-waynechi.dev/_next/static/chunks/pages/%5Bslug%5D-359e4aa19627ad0c9516.js" defer=""></script><script src="https://radicaldilettante.github.io/expired-waynechi.dev/_next/static/AHlsYJ1W-SJCeqAX_lFDN/_buildManifest.js" defer=""></script><script src="https://radicaldilettante.github.io/expired-waynechi.dev/_next/static/AHlsYJ1W-SJCeqAX_lFDN/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="style_container__1fUIW"><header class="style_header__1vTJ4 theme_light__2lu4I"><div class="style_container__3a_wR"><div class="style_header__1ynE4"><button class="style_mobileMenuButton__1APOa"><img alt="open_menu_bar" src="https://radicaldilettante.github.io/expired-waynechi.dev/images/menu.svg"/></button><a class="style_name__c3MEE" href="/">WayneChoi.dev</a><ul class="style_list__chEFJ"><li><div><a href="/expired-waynechi.dev/">HOME</a></div></li><li><div><a href="/expired-waynechi.dev/about">ABOUT</a></div></li><li><div><a href="/expired-waynechi.dev/portfolio">PORTFOLIO</a></div></li><li><div><a href="/expired-waynechi.dev/cv" target="_blank">CV</a></div></li><li><button class="style_cliButton__3JcSL"><img src="https://radicaldilettante.github.io/expired-waynechi.dev/images/cli.png" alt="cli_mode"/></button></li></ul><div class="style_searchBar__FDBv7"><form class="style_container__j4rCB theme_light__2lu4I"><input type="text" id="keyword" placeholder="keywords..." required="" class="theme_light__2lu4I"/><button type="submit"><img alt="search" src="https://radicaldilettante.github.io/expired-waynechi.dev/images/search.svg"/></button></form></div><button class="style_mobileSearchButton__1AMGz"><img alt="open_search_bar" src="https://radicaldilettante.github.io/expired-waynechi.dev/images/search.svg"/></button></div></div></header><section class="style_contents__1dCqS"><div class="blog_container__2sPBE"><div class="blog_tagWrapper__1MSFu"><span class="blog_tag__3CYz_">#<!-- -->Web</span><span class="blog_tag__3CYz_">#<!-- -->Cookie</span><span class="blog_tag__3CYz_">#<!-- -->JavaScript</span></div><h1 class="blog_h1__3a0RO">Method returning callback with this for event handler</h1><span class="blog_date__3Pnjx">Apr 4, 2022</span><div class="blog_content__2NI78"><div class="style_container__2jJTZ"></div></div></div></section><footer class="style_footer__1H40h">(C) <!-- -->2023<!-- -->. Wonjun Choi. All rights reserved.</footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"title":"Method returning callback with this for event handler","date":"Apr 4, 2022","tag":["Web","Cookie","JavaScript"],"excerpt":"I met a trobule about this in a method returning callback for event handler. I fixed it with static method and other hack.","content":"\nAll code is not real codes, but abstracted to understand this issue easily.\n\n```TypeScript\nexport default class SignUpService {\n  private urlBase: string;\n\n  constructor(urlBase: string) {\n    this.urlBase = urlBase;\n  }\n\n  public usernameFilter = () =\u003e {\n    return async (username: string) =\u003e {\n      // skip\n\n      console.log(this.urlBase)\n      return `The username, ${username}, is already exist.`;\n    };\n  };\n}\n\n// this was undefined when usernameFilter method was called in event handler.\n```\n\nusernameFilter method return an async callback, and it is called in DOM event handler. this in event handler is unexpected and not under my control. In the case of this project, this was undefined.\n\n## Static Method\n\n```TypeScript\nexport default class SignUpService {\n\n  static usernameFilter = (urlBase: string) =\u003e {\n    return async (username: string) =\u003e {\n      // skip\n\n      console.log(urlBase)\n      return `The username, ${username}, is already exist.`;\n    };\n  };\n}\n```\n\nAt first, I made all methods static, and injected all dependency as a parameter. The code above is quite simple, but real code was not. There were plenty of duplicated codes.\n\nThat was not cool.\n\n## this in arrow function\n\nthis is set when execution of method or function. However, this in arrow function is set when the function is declared.\n\nThe async callback returned in usernameFilter method is declared in the rendering method of React library in this project. I am not sure how it works, and I could not help it.\n\n```TypeScript\nexport default class SignUpService {\n  private urlBase: string;\n\n  constructor(urlBase: string) {\n    this.urlBase = urlBase;\n  }\n\n  public usernameFilter = () =\u003e {\n    const urlBase = this.urlBase\n\n    return async (username: string) =\u003e {\n      // skip\n\n      console.log(urlBase)\n      return `The username, ${username}, is already exist.`;\n    };\n  };\n}\n```\n\nSo I re-declare member, I need, in usernameFilter methods, and use it in the callback returned. usernameFilter method is declared when making an instance of the class, so this should be the instance.\n"},"__N_SSG":true},"page":"/[slug]","query":{"slug":"method_returning_callback_with_this_for_event_handler"},"buildId":"AHlsYJ1W-SJCeqAX_lFDN","assetPrefix":"https://radicaldilettante.github.io/expired-waynechi.dev","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>